@model MeetingVL.Models.Evaluate

@{
    ViewBag.Title = "Details";
    Layout = "~/Views/Shared/_Layout_MeetingVL.cshtml";
    int group_id = 0;
    string role = "";
    if (TempData["group_id"] != null )
    {
        group_id = int.Parse(TempData["group_id"].ToString());

    }
    if (TempData["role"] != null)
    {

        role = TempData["role"].ToString();
    }
    string avt = "";
    if (Model.User.Avt != null)
    {
        avt = Model.User.Avt;
    }
    else
    {
        avt = "~/Template/app-assets/img/user.png";
    }
}

<div class="timeline-card card border-grey border-lighten-2">
    @if (role == "Manager")
    {
    <div class="dropdown nav-item mt-1 actions ">
        <a id="apps" href="" data-toggle="dropdown" class="ft-more-horizontal grey" aria-expanded="false"></a>
        <div class="dropdown-menu dropdown-menu-right">
            <div class="arrow_box_right">
                <a href="" class="dropdown-item py-1" data-toggle="modal" data-target="#EditEvalute">
                    <span> Edit</span>
                </a>
                <a class="dropdown-item py-1" data-toggle="modal" data-target="#DeleteEvalute">
                    <span> Delete</span>
                </a>
            </div>
        </div>
    </div>
    }
    
    <div class="card-header">
        <h4 class="card-title mb-0">
            Review - @Model.Group.Name
        </h4>
        <br />
        <div class="media">
            <div class="media-left mr-2">
                <a>
                    <span class="avatar avatar-md avatar-busy">
                        <img src="@Url.Content(avt)" class="rounded-circle" alt="avatar" width="50">
                    </span>
                    <i></i>
                </a>
            </div>
            <div class="media-body">

                <b>@Model.User_ID</b>

                <div class="card-subtitle text-muted mt-0">
                    <span class="font-small-3">@Model.Time</span>
                    <span class="tag tag-pill tag-default tag-warning float-right">Point: @Model.Point</span>
                </div>
            </div>
        </div>
    </div>
    <div class="card-body">
        <div class="card-body">
            <div class="card-block">
                <p class="card-text">
                    @Model.Review
                </p>
                <div class="list-inline mb-1">
                    <span class="pr-1">
                        <a class="primary">
                            <span class="fa fa-commenting-o"></span> Comment
                        </a>
                    </span>
                </div>
            </div>
        </div>
        <div class="card-footer px-0 py-0">
            <div class="card-block">
                @Html.Action("Index", "Comments", new { evalute_id = Model.ID })
                @if (role == "Manager" || group_id == Model.Group_ID)
                {
                    using (Html.BeginForm("Create", "Comments", FormMethod.Post, new { enctype = "multipart/form-data" }))
                    {
                        @Html.AntiForgeryToken()
                        @Html.Hidden("evalute_id", Model.ID);
                        <form>
                            <fieldset class="form-group position-relative has-icon-left mb-0">
                                <input type="text" class="form-control" placeholder="Write comments..." name="comment">
                                <div class="form-control-position">
                                    <i class="fa fa-dashcube"></i>
                                </div>
                            </fieldset>
                        </form>
                    }
                }

            </div>
        </div>
    </div>
</div>

<div class="modal fade text-left" id="EditEvalute" tabindex="-1" role="dialog" aria-labelledby="myModalLabel34" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="myModalLabel34">Edit student</h3>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            @using (Html.BeginForm("Edit", "Evaluates", FormMethod.Post, new { enctype = "multipart/form-data" }))
            {
                @Html.AntiForgeryToken()
                @Html.Hidden("id", Model.ID)
              
                <div class="modal-body">
                    <div class="col-md-12">
                        <div class="form-group">
                            <label for="projectinput1">Point: </label>
                            <input class="form-control border-primary" type="number" id="Deadline" name="point" max="10" min="0" value="@Model.Point">
                        </div>
                        <div class="form-group">
                            <label for="projectinput1">Review: </label>
                            <textarea class="form-control border-primary" id="Descriptions" name="review"
                                      required="required" oninvalid="this.setCustomValidity('Please enter Review')" oninput="setCustomValidity('')">@Model.Review</textarea>
                        </div>

                    </div>
                </div>
                <div class="modal-footer">
                    <input type="reset" class="btn btn-outline-secondary btn-lg" data-dismiss="modal" value="Cancel">
                    <input type="submit" class="btn btn-outline-primary btn-lg" value="Save">
                </div>
            }
        </div>
    </div>
</div>
<div class="modal fade text-left" id="DeleteEvalute" tabindex="-1" role="dialog" aria-labelledby="myModalLabel1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="myModalLabel1"><b>Notification</b></h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <h5>Are you sure?</h5>
                <p>When you delete the Evalute. You won't be able to revert this!</p>
            </div>
            <div class="modal-footer">
                @using (Html.BeginForm("Delete", "Evaluates", new { id = Model.ID }))
                {
                    
                    @Html.AntiForgeryToken()
                    @Html.Hidden("semester_id", Model.Semester_ID)
                    <button type="button" class="btn grey btn-outline-secondary" data-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-outline-primary">Yes</button>
                }
            </div>
        </div>
    </div>
</div>
